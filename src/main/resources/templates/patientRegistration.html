<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Smart Hospital - Patient Registration</title>
  <link rel="stylesheet" href="/css/patientRegistration.css">

  <!-- Keep only logo positioning critical CSS -->
  <style>
    /* Logo section forced positioning - override shared layout */
    .simple-header .header-container .logo-section {
      position: absolute !important;
      left: -300px !important;
      top: -60px !important;
      z-index: 10 !important;
      transform: none !important;
    }

    .simple-header .header-container .hospital-logo-img {
      width: 200px !important;
      height: 200px !important;
      object-fit: contain !important;
    }

    /* Loading spinner */
    .spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
      margin-right: 10px;
      vertical-align: middle;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Success message */
    .success-message {
      background-color: #d4edda;
      color: #155724;
      padding: 12px;
      border-radius: 4px;
      margin-bottom: 20px;
      text-align: center;
      display: none;
    }
  </style>
</head>
<body>
<!-- Blue Header with Logo -->
<header class="simple-header">
  <div class="header-container">
    <div class="logo-section">
      <img src="/SharedLayoutImages/LogoCircle.png" alt="Smart Hospital Logo" class="hospital-logo-img">
    </div>
    <div class="registration-section">
      <h1>Registration</h1>
    </div>
  </div>
</header>

<!-- Main Content Container -->
<div class="content-container">
  <div class="success-message" id="successMessage">
    Registration successful! Redirecting to homepage...
  </div>

  <form id="patientRegistrationForm" method="post">

    <!-- Main Form Section -->
    <div class="form-section">
      <div class="form-grid">
        <div class="form-field">
          <label>First Name *</label>
          <input type="text" name="firstName" id="firstName">
          <div class="error-message" id="firstName-error"></div>
        </div>

        <div class="form-field">
          <label>Last Name *</label>
          <input type="text" name="lastName" id="lastName">
          <div class="error-message" id="lastName-error"></div>
        </div>

        <div class="form-field">
          <label>Date of Birth *</label>
          <input type="date" name="dateOfBirth" id="dateOfBirth">
          <div class="error-message" id="dateOfBirth-error"></div>
        </div>

        <div class="form-field">
          <label>Gender *</label>
          <select name="gender" id="gender">
            <option value="">Select Gender</option>
            <option value="0">Male</option>
            <option value="1">Female</option>
            <option value="2">Other</option>
          </select>
          <div class="error-message" id="gender-error"></div>
        </div>

        <div class="form-field">
          <label>Blood Type *</label>
          <select name="bloodType" id="bloodType">
            <option value="">Select Blood Type</option>
            <option value="1">A+</option>
            <option value="2">A-</option>
            <option value="3">B+</option>
            <option value="4">B-</option>
            <option value="5">AB+</option>
            <option value="6">AB-</option>
            <option value="7">O+</option>
            <option value="8">O-</option>
          </select>
          <div class="error-message" id="bloodType-error"></div>
        </div>

        <div class="form-field">
          <label>Height *</label>
          <div class="input-with-unit">
            <input type="number" step="0.1" name="height" id="height">
            <span class="unit">cm</span>
          </div>
          <div class="error-message" id="height-error"></div>
        </div>

        <div class="form-field">
          <label>Weight *</label>
          <div class="input-with-unit">
            <input type="number" step="0.1" name="weight" id="weight">
            <span class="unit">kg</span>
          </div>
          <div class="error-message" id="weight-error"></div>
        </div>

        <div class="form-field full-width">
          <label>Home Address *</label>
          <textarea name="homeAddress" id="homeAddress" rows="3" placeholder="Enter your full address"></textarea>
          <div class="error-message" id="homeAddress-error"></div>
        </div>

        <div class="form-field">
          <label>National ID *</label>
          <input type="text" name="nationalId" id="nationalId" placeholder="13-digit National ID">
          <div class="error-message" id="nationalId-error"></div>
        </div>

        <div class="form-field">
          <label>Email *</label>
          <input type="email" name="email" id="email">
          <div class="error-message" id="email-error"></div>
        </div>

        <div class="form-field">
          <label>Mobile Number *</label>
          <input type="tel" name="mobileNumber" id="mobileNumber" placeholder="9-digit number">
          <div class="error-message" id="mobileNumber-error"></div>
        </div>

        <div class="form-field">
          <label>Nearest Clinic *</label>
          <input type="text" name="nearestClinic" id="nearestClinic" placeholder="Enter your nearest clinic">
          <div class="error-message" id="nearestClinic-error"></div>
        </div>

        <div class="form-field">
          <label>Password *</label>
          <input type="password" name="password" id="password" required minlength="8">
          <div class="error-message" id="password-error"></div>
        </div>

        <div class="form-field">
          <label>Confirm Password *</label>
          <input type="password" name="confirmPassword" id="confirmPassword" required minlength="8">
          <div class="error-message" id="confirmPassword-error"></div>
        </div>
      </div>
    </div>

    <!-- Emergency Contact Section -->
    <div class="form-section">
      <div class="section-header">
        <h3>Emergency Contact</h3>
      </div>

      <div class="form-grid-emergency">
        <div class="form-field">
          <label>First Name *</label>
          <input type="text" name="emergencyFirstName" id="emergencyFirstName">
          <div class="error-message" id="emergencyFirstName-error"></div>
        </div>

        <div class="form-field">
          <label>Last Name *</label>
          <input type="text" name="emergencyLastName" id="emergencyLastName">
          <div class="error-message" id="emergencyLastName-error"></div>
        </div>

        <div class="form-field">
          <label>Relationship to Patient *</label>
          <select name="emergencyRelationship" id="emergencyRelationship">
            <option value="">Select Relationship</option>
            <option value="1">Parent</option>
            <option value="2">Spouse</option>
            <option value="3">Child</option>
            <option value="4">Sibling</option>
            <option value="5">Other Relative</option>
            <option value="6">Friend</option>
            <option value="7">Other</option>
          </select>
          <div class="error-message" id="emergencyRelationship-error"></div>
        </div>

        <div class="form-field full-width">
          <label>Phone Number *</label>
          <input type="tel" name="emergencyPhone" id="emergencyPhone">
          <div class="error-message" id="emergencyPhone-error"></div>
        </div>
      </div>

      <!-- Medical History -->
      <div class="medical-section">
        <div class="section-header">
          <h3>Medical History</h3>
        </div>

        <div class="medical-grid">
          <div class="form-field">
            <label>Current Condition</label>
            <textarea name="currentConditionDetails" id="currentConditionDetails"
                      placeholder="Blurred vision for two days" rows="2"></textarea>
            <div class="error-message" id="currentConditionDetails-error"></div>
          </div>

          <div class="form-field">
            <label>Allergies</label>
            <textarea name="allergies" id="allergies"
                      placeholder="List any known allergies (medications, foods, etc.)" rows="3"></textarea>
            <div class="error-message" id="allergies-error"></div>
          </div>

          <div class="form-field">
            <label>Current Medications</label>
            <textarea name="currentMedications" id="currentMedications"
                      placeholder="List all medications you are currently taking" rows="3"></textarea>
            <div class="error-message" id="currentMedications-error"></div>
          </div>

          <div class="form-field">
            <label>Past Medical Conditions</label>
            <textarea name="pastMedicalConditions" id="pastMedicalConditions"
                      placeholder="Including chronic conditions (e.g., Type 2 Diabetes Mellitus)" rows="3"></textarea>
            <div class="error-message" id="pastMedicalConditions-error"></div>
          </div>

          <div class="form-field">
            <label>Past Surgical History</label>
            <textarea name="pastSurgicalHistory" id="pastSurgicalHistory"
                      placeholder="Previous surgeries and dates" rows="2"></textarea>
            <div class="error-message" id="pastSurgicalHistory-error"></div>
          </div>

          <div class="form-field">
            <label>Past Medications</label>
            <textarea name="pastMedications" id="pastMedications"
                      placeholder="Previous medications and reasons for discontinuation" rows="2"></textarea>
            <div class="error-message" id="pastMedications-error"></div>
          </div>

          <div class="form-field">
            <label>Family History</label>
            <textarea name="familyHistory" id="familyHistory"
                      placeholder="e.g., Father with Type 2 Diabetes" rows="2"></textarea>
            <div class="error-message" id="familyHistory-error"></div>
          </div>

          <div class="form-field">
            <label>Social History</label>
            <textarea name="socialHistory" id="socialHistory"
                      placeholder="e.g., Non-smoker, no alcohol" rows="2"></textarea>
            <div class="error-message" id="socialHistory-error"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Profile Picture Section with Buttons -->
    <div class="form-section">
      <div class="section-header">
        <h3>Profile Picture</h3>
      </div>

      <div class="profile-upload">
        <div class="profile-preview">
          <div class="profile-placeholder" id="profilePlaceholder">
            <div class="placeholder-icon">ðŸ‘¤</div>
            <div class="placeholder-text">No photo selected</div>
          </div>
          <img id="profilePreview" style="display: none;">
        </div>

        <input type="file" id="profilePictureInput" name="profilePicture"
               accept="image/*" style="display: none;">
        <input type="file" id="cameraInput" name="cameraInput"
               accept="image/*" capture="user" style="display: none;">
        <div class="upload-buttons">
          <button type="button" class="upload-btn" onclick="document.getElementById('cameraInput').click()">
            Take a picture
          </button>
          <button type="button" class="upload-btn secondary" onclick="document.getElementById('profilePictureInput').click()">
            Upload a photo
          </button>
        </div>
      </div>

      <!-- Hidden field for avatar URL -->
      <input type="hidden" id="avatarBase64" name="avatarBase64">

      <!-- Form Buttons moved inside Profile Picture section -->
      <div class="form-buttons-integrated">
        <button type="button" class="btn-back" onclick="cancelRegistration()">>Back</button>
        <button type="submit" class="btn-register" id="registerButton">
          <span class="button-text">Register</span>
          <span class="spinner" style="display: none;"></span>
        </button>
      </div>
    </div>
  </form>
</div>

<!-- JavaScript Files -->
<script src="/js/patientRegistration.js"></script>
</body>
</html>
