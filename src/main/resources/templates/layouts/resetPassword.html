<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Reset Password - Smart Hospital</title>
  <link rel="stylesheet" href="/css/resetPassword.css" />
</head>
<body>

<div class="reset-container">
  <div class="header">
    <div class="logo">
      <img src="/SharedLayoutImages/LogoCircle.png" alt="Logo" />
    </div>
    <h1>Reset Password</h1>
  </div>

  <div class="form-container">
    <form action="/resetPassword" method="post" class="reset-form">
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" id="email" name="email" required>
      </div>

      <div class="form-group">
        <label for="newPassword">New Password</label>
        <input type="password" id="newPassword" name="newPassword" required>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirm New Password</label>
        <input type="password" id="confirmPassword" name="confirmPassword" required>
      </div>

      <div class="button-group">
        <button type="button" class="btn btn-back" onclick="goBack()">BACK</button>
        <button type="submit" class="btn btn-confirm">CONFIRM</button>
      </div>
    </form>
  </div>
</div>

<script>
  // Reset Password Page JavaScript

  document.addEventListener('DOMContentLoaded', function() {
    const form = document.querySelector('.reset-form');
    const newPasswordInput = document.getElementById('newPassword');
    const confirmPasswordInput = document.getElementById('confirmPassword');

    // Real-time password match validation
    confirmPasswordInput.addEventListener('input', function() {
      const newPassword = newPasswordInput.value;
      const confirmPassword = this.value;

      if (confirmPassword.length > 0) {
        if (newPassword !== confirmPassword) {
          this.style.borderColor = '#e74c3c';
          this.style.background = '#ffeaa7';
        } else {
          this.style.borderColor = '#27ae60';
          this.style.background = '#d5f4e6';
        }
      } else {
        this.style.borderColor = '#ddd';
        this.style.background = '#f9f9f9';
      }
    });

    // Form submission validation
    if (form) {
      form.addEventListener('submit', function(e) {
        const newPassword = newPasswordInput.value;
        const confirmPassword = confirmPasswordInput.value;

        // Check if passwords match
        if (newPassword !== confirmPassword) {
          e.preventDefault();
          showError('Passwords do not match. Please try again.');
          confirmPasswordInput.focus();
          return false;
        }

        // Check password length
        if (newPassword.length < 6) {
          e.preventDefault();
          showError('Password must be at least 6 characters long.');
          newPasswordInput.focus();
          return false;
        }
      });
    }

    // Show error message
    function showError(message) {
      // Remove existing error messages
      const existingError = document.querySelector('.error-message');
      if (existingError) {
        existingError.remove();
      }

      // Create new error message
      const errorDiv = document.createElement('div');
      errorDiv.className = 'error-message';
      errorDiv.textContent = message;

      // Insert before button group
      const buttonGroup = document.querySelector('.button-group');
      buttonGroup.parentNode.insertBefore(errorDiv, buttonGroup);

      // Auto-remove after 5 seconds
      setTimeout(() => {
        if (errorDiv.parentNode) {
          errorDiv.remove();
        }
      }, 5000);
    }

    // Email validation
    const emailInput = document.getElementById('email');
    if (emailInput) {
      emailInput.addEventListener('blur', function() {
        const email = this.value;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

        if (email && !emailRegex.test(email)) {
          this.style.borderColor = '#e74c3c';
          this.style.background = '#ffeaa7';
        } else {
          this.style.borderColor = '#ddd';
          this.style.background = '#f9f9f9';
        }
      });
    }
  });

  // Go back function
  function goBack() {
    if (window.history.length > 1) {
      window.history.back();
    } else {
      // Fallback to login page
      window.location.href = '/login';
    }
  }
</script>
</body>
</html>
