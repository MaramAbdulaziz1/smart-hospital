<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Clinical Notes</title>
    <link rel="stylesheet" th:href="@{/css/sharedLayout.css}">
    <link rel="stylesheet" href="/css/clinicalNotes.css" />
</head>

<body>
<div class="layout-container">
    <!-- Sidebar -->
    <aside th:replace="~{layouts/sharedLayout :: sidebar (activePage='clinicalNotes', appointmentId=${appointmentId})}"></aside>
    <!--main content-->
    <main class="main-content">
        <!-- Top Navigation -->
      <header th:replace="components/top-navD :: top-nav('Clinical Notes')"></header>
      <!-- Patient Info Card -->
      <section th:replace="components/patientCard :: patientCard(${appointmentId})"></section>
        <section class="page-content">
            <!--intake section-->
            <div class="form-column">
                <div>
                    <div class="tabs active">Patient Complaint</div>
                    <textarea class="intake-card complaint" disabled></textarea>
                </div>
                <div class="form-row">
                    <div>
                        <div>
                            <div class="tabs sub-tabs active">Note</div>
                            <div class="tabs sub-tabs">Diagnosis</div>
                            <div class="tabs sub-tabs">Medical History</div>
                            <div class="tabs sub-tabs">Follow-up Plan</div>
                        </div>
                        <textarea class="intake-card diagnosis" disabled placeholder = 'Click "Edit" to enter note...'></textarea>
                    </div>
                    <div class="button-group">
                        <button class="edit-btn" onclick="enableSection()">Edit</button>
                        <button class="save-btn">Save</button>
                        <button class="submit-btn">Submit</button>
                    </div>
                </div>
            </div>
        </section>
    </main>
</div>

<!--button function(should be refractor later)-->
<script>
    //edit button
    function enableSection() {
        const diagnosisTextarea = document.querySelector('.intake-card.diagnosis');
        if (diagnosisTextarea) {
            diagnosisTextarea.removeAttribute('disabled');
            diagnosisTextarea.focus();
        }
    }

    // find all .sub-tabs elements
    document.querySelectorAll('.sub-tabs').forEach(tab => {
        tab.addEventListener('click', () => {
        // 1. delete all active from .tabs
        document.querySelectorAll('.sub-tabs').forEach(t => t.classList.remove('active'));

        // 2. activ current .tabs
        tab.classList.add('active');

        // 3. adjust placeholder content based on the active tab
        const textarea = document.querySelector('.intake-card.diagnosis');
        const tabText = tab.textContent.trim();

        if (tabText === 'Note') {
            textarea.placeholder = 'Click "Edit" to enter note...';
        } else if (tabText === 'Diagnosis') {
            textarea.placeholder = 'Click "Edit" to enter diagnosis...';
        } else if (tabText === 'Medical History') {
            textarea.placeholder = 'Click "Edit" to enter medical history...';
        } else if (tabText === 'Follow-up Plan') {
            textarea.placeholder = 'Click "Edit" to enter follow-up plan...';
        }
        });
    });

    // Save and Submit button functionality
    document.addEventListener('DOMContentLoaded', function() {
        const saveBtn = document.querySelector('.save-btn');
        const submitBtn = document.querySelector('.submit-btn');
        const editBtn = document.querySelector('.edit-btn');
        const textarea = document.querySelector('.intake-card.diagnosis');

        // Save button functionality
        saveBtn.addEventListener('click', function() {
            if (textarea.disabled) {
                showNotification('Please click "Edit" first to enable editing', 'warning');
                return;
            }

            const content = textarea.value.trim();
            if (!content) {
                showNotification('Please enter some content before saving', 'warning');
                return;
            }

            // Show saving state
            saveBtn.textContent = 'Saving...';
            saveBtn.disabled = true;

            // Simulate save operation
            setTimeout(() => {
                showNotification('Clinical notes saved successfully!', 'success');
                saveBtn.textContent = 'Save';
                saveBtn.disabled = false;
            }, 1000);
        });

        // Submit button functionality
        submitBtn.addEventListener('click', function() {
            if (textarea.disabled) {
                showNotification('Please click "Edit" first to enable editing', 'warning');
                return;
            }

            const content = textarea.value.trim();
            if (!content) {
                showNotification('Please enter some content before submitting', 'warning');
                return;
            }

            // Show submitting state
            submitBtn.textContent = 'Submitting...';
            submitBtn.disabled = true;
            saveBtn.disabled = true;
            editBtn.disabled = true;

            // Simulate submit operation
            setTimeout(() => {
                showNotification('Clinical notes submitted successfully!', 'success');
                submitBtn.textContent = 'Submit';
                submitBtn.disabled = false;
                saveBtn.disabled = false;
                editBtn.disabled = false;

                // Disable textarea after successful submit
                textarea.disabled = true;
                textarea.placeholder = 'Notes have been submitted. Click "Edit" to make changes...';
            }, 1500);
        });

        // Show notification function
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;

            // Set background color based on type
            let bgColor = '#4CAF50'; // success
            if (type === 'warning') bgColor = '#FF9800';
            if (type === 'error') bgColor = '#f44336';

            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${bgColor};
                color: white;
                padding: 12px 20px;
                border-radius: 6px;
                z-index: 10000;
                font-size: 14px;
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.3s ease;
                max-width: 300px;
                word-wrap: break-word;
            `;

            document.body.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.style.opacity = '1';
                notification.style.transform = 'translateX(0)';
            }, 10);

            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, 3000);
        }
    });

</script>

<!-- Scripts -->
<script th:src="@{/js/sharedLayout.js}"></script>
</body>
</html>




